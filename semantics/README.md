# Using Semantic UCCA Transitions with Nematus
The files in this directory are used to run Nematus using semantic transition generated by TUPA.

## How to Run
1. Follow the instructions [in the TUPA package](https://github.com/danielhers/tupa#pre-trained-models-with-bert)
to get the pre-trained bert model.
2. Make sure you have the requirements in requirements.txt and requirements.bert.txt.  
You may want to run `pip install -r requirements.txt` and `pip install -r requirements.bert.txt`
3. Setup the running scripts:
    * To run full training - change the parameters in the `scripts/generate_semantics_and_train.sh` script, under "Setup path and data Variables".    
    Make sure you have the validation files ready (you would need to generate the semantic transitions for them).  
    If there is an existing transitions file, the script will not overwrite it and skip the file creation.
    * To only generate the transitions file - change the parameters in the `scripts/generate_semantics.sh` script.  
4. Run the modified `scripts/generate_semantics_and_train.sh` script.

## Special points of interest in Nematus code.
Most future changes to this should be done in the `convert_semantic_transitions_text_to_graph()` function, under `nematus/data_iterator.py`, and where this function is called.  
Another point of interest is the FileWrapper class in data_iterator.py, which was changed to consume a lines file indicating which lines should be processed.

## Notes
* The length of the transitions here is long. This means more memory consumption and longer run time. Consider this.
* For the above reason, validation set used was capped to 1000 sentences, and it still takes a long time to validate.
